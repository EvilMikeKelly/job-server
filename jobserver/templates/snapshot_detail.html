{% extends "base.html" %}

{% load static %}

{% block content %}

<nav aria-label="breadcrumb">
  <ol class="breadcrumb">

    <li class="breadcrumb-item"><a href="/">Home</a></li>

    <li class="breadcrumb-item">
      <a href="{{ snapshot.workspace.project.org.get_absolute_url }}">
        {{ snapshot.workspace.project.org.name }}
      </a>
    </li>

    <li class="breadcrumb-item">
      <a href="{{ snapshot.workspace.project.get_absolute_url }}">
        {{ snapshot.workspace.project.name }}
      </a>
    </li>

    <li class="breadcrumb-item">
      <a href="{{ snapshot.workspace.get_absolute_url }}">
        {{ snapshot.workspace.name }}
      </a>
    </li>

    <li class="breadcrumb-item">
      <a href="{{ snapshot.workspace.get_outputs_url }}">
        Outputs
      </a>
    </li>

    <li class="breadcrumb-item active" aria-current="page">{{ snapshot.id }}</li>

  </ol>
</nav>

{% if request.user.is_anonymous %}
<div class="card mb-3">
  <div class="card-header d-flex justify-content-between align-items-center">
    <h1 class="h3 mb-0">Published outputs from {{ snapshot.workspace.name }}</h1>

    <div>
      <a class="btn btn-sm btn-primary" href="{{ snapshot.get_download_url }}">
        Download
      </a>
    </div>
  </div>
  <div class="card-body">
    <p class="card-text">
      Published by {{ snapshot.published_by.name }} on
      {{ snapshot.published_at|date:"D M Y" }} at {{ snapshot.published_at|date:"H:i" }}
    </p>
  </div>
</div>
{% endif %}

{% if request.user.is_authenticated %}
<div class="card border-{% if snapshot.is_draft %}warning{% else %}success{% endif %} mb-3">
  <div class="card-header d-flex justify-content-between align-items-center border-{% if snapshot.is_draft %}warning{% else %}success{% endif %}">
    <h1 class="h3 mb-0">
      {% if snapshot.is_draft %}Draft{% else %}Published{% endif %}
      outputs from {{ snapshot.workspace.name }}

      {% if snapshot.is_draft %}
        <span class="badge badge-secondary">Draft</span>
      {% endif %}
    </h1>

    <div>
      <a class="btn btn-sm btn-primary mr-2" href="{{ release.get_download_url }}">
        Download
      </a>
      <span
        class="btn btn-sm font-weight-bold btn-{% if snapshot.is_draft %}warning{% else %}success{% endif %} px-3"
        data-placement="bottom"
        data-toggle="tooltip"
        data-tooltip="warning"
        title="You can see these outputs because you have been assigned the ProjectCollaborator role.">
          <span class="sr-only">You can see these outputs because you have been assigned the ProjectCollaborator role.</span>
          <span aria-hidden>?</span>
      </span>
    </div>
  </div>
  <div class="card-body">
    <p class="card-text">
      {% if snapshot.is_draft %}
      Prepared for publishing by {{ snapshot.created_by.name }} on
      {{ snapshot.created_at|date:"D M Y" }} at {{ snapshot.created_at|date:"H:i" }}
      {% else %}
      Published by {{ snapshot.published_by.name }} on
      {{ snapshot.published_at|date:"D M Y" }} at {{ snapshot.published_at|date:"H:i" }}
      {% endif %}
    </p>
  </div>
</div>
{% endif %}

{% include "outputs-spa.html" %}

{% endblock %}
